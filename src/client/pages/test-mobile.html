<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Interface Mobile</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #0a0a1a;
            color: white;
            text-align: center;
        }
        .test-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        .success { border-left: 5px solid #4caf50; }
        .error { border-left: 5px solid #f44336; }
        .warning { border-left: 5px solid #ff9800; }
        .button {
            background: #5b3cc4;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            margin: 10px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
        }
        .button:hover {
            background: #7e57c2;
        }
    </style>
</head>
<body>
    <h1>üß™ Test Interface Mobile</h1>
    
    <div class="test-card">
        <h2>1. Test de Connectivit√© Serveur</h2>
        <button class="button" onclick="testServer()">Tester Serveur</button>
        <div id="serverResult"></div>
    </div>

    <div class="test-card">
        <h2>2. Test de D√©tection Mobile</h2>
        <div id="deviceInfo">
            <p><strong>User Agent:</strong> <span id="userAgent"></span></p>
            <p><strong>Taille √©cran:</strong> <span id="screenSize"></span></p>
            <p><strong>Mobile d√©tect√©:</strong> <span id="isMobile"></span></p>
        </div>
    </div>

    <div class="test-card">
        <h2>3. Test Interface Mobile</h2>
        <a href="/mobile" class="button">Ouvrir Interface Mobile</a>
        <a href="/desktop" class="button">Ouvrir Interface Desktop</a>
        <a href="/login" class="button">Test Connexion Spotify</a>
    </div>

    <div class="test-card">
        <h2>4. √âtats des Scripts</h2>
        <div id="scriptsStatus"></div>
        <button class="button" onclick="checkScripts()">V√©rifier Scripts</button>
    </div>

    <script>
        function updateDeviceInfo() {
            document.getElementById('userAgent').textContent = navigator.userAgent;
            document.getElementById('screenSize').textContent = `${window.innerWidth}x${window.innerHeight}`;
            
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ||
                           (window.innerWidth <= 768 && window.innerHeight <= 1024);
            
            const mobileSpan = document.getElementById('isMobile');
            mobileSpan.textContent = isMobile ? '‚úÖ OUI' : '‚ùå NON';
            mobileSpan.style.color = isMobile ? '#4caf50' : '#f44336';
        }

        async function testServer() {
            const resultDiv = document.getElementById('serverResult');
            resultDiv.innerHTML = '<p>üîÑ Test en cours...</p>';
            
            try {
                const response = await fetch('/api/me/playlists?token=test');
                if (response.status === 400) {
                    resultDiv.innerHTML = '<p class="success">‚úÖ Serveur op√©rationnel (erreur 400 attendue)</p>';
                } else {
                    resultDiv.innerHTML = `<p class="warning">‚ö†Ô∏è R√©ponse inattendue: ${response.status}</p>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<p class="error">‚ùå Erreur: ${error.message}</p>`;
            }
        }

        function checkScripts() {
            const statusDiv = document.getElementById('scriptsStatus');
            const scripts = [
                { name: 'Popup.js', test: () => typeof showPopup !== 'undefined' },
                { name: 'SpotifyV2.js', test: () => typeof appState !== 'undefined' },
                { name: 'game.js', test: () => typeof initUI !== 'undefined' },
                { name: 'mobile.js', test: () => typeof MobileInterface !== 'undefined' }
            ];
            
            let html = '<div style="text-align: left;">';
            scripts.forEach(script => {
                const available = script.test();
                html += `<p>${available ? '‚úÖ' : '‚ùå'} ${script.name}: ${available ? 'Charg√©' : 'Non disponible'}</p>`;
            });
            html += '</div>';
            
            statusDiv.innerHTML = html;
        }

        // V√©rification automatique
        updateDeviceInfo();
        window.addEventListener('resize', updateDeviceInfo);
        
        // Test automatique au chargement
        setTimeout(() => {
            testServer();
            checkScripts();
        }, 1000);
    </script>
</body>
</html>
